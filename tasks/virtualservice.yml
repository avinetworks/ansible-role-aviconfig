# Automatically Generated File
# Copyright 2021 VMware, Inc. All rights reserved. VMware Confidential
---
- name: Avi VirtualService | Create or Update VirtualService
  no_log: "{{ avi_role_config_log_mode | default(False) }}"
  avi_virtualservice:
    controller: "{{ avi_controller | default(omit) }}"
    username: "{{ avi_username | default(omit) }}"
    password: "{{ avi_password | default(omit) }}"
    tenant: "{{ item.tenant | default(omit) }}"
    state: "{{ avi_role_state_mode }}"
    api_version: "{{ api_version | default(omit) }}"
    avi_credentials: "{{ avi_credentials | default(omit) }}"
    api_context: "{{ avi_api_context | default(omit) }}"
    avi_api_update_method: "{{ item.avi_api_update_method | default(omit) }}"
    avi_api_patch_op: "{{ item.avi_api_patch_op | default(omit) }}"
    active_standby_se_tag: "{{ item.active_standby_se_tag | default(omit) }}"
    advertise_down_vs: "{{ item.advertise_down_vs | default(omit) }}"
    allow_invalid_client_cert: "{{ item.allow_invalid_client_cert | default(omit) }}"
    analytics_policy: "{{ item.analytics_policy | default(omit) }}"
    analytics_profile_ref: "{{ item.analytics_profile_ref | default(omit) }}"
    application_profile_ref: "{{ item.application_profile_ref | default(omit) }}"
    azure_availability_set: "{{ item.azure_availability_set | default(omit) }}"
    bgp_peer_labels: "{{ item.bgp_peer_labels | default(omit) }}"
    bot_policy_ref: "{{ item.bot_policy_ref | default(omit) }}"
    bulk_sync_kvcache: "{{ item.bulk_sync_kvcache | default(omit) }}"
    close_client_conn_on_config_update: "{{ item.close_client_conn_on_config_update | default(omit) }}"
    cloud_config_cksum: "{{ item.cloud_config_cksum | default(omit) }}"
    cloud_ref: "{{ item.cloud_ref | default(omit) }}"
    cloud_type: "{{ item.cloud_type | default(omit) }}"
    configpb_attributes: "{{ item.configpb_attributes | default(omit) }}"
    connections_rate_limit: "{{ item.connections_rate_limit | default(omit) }}"
    content_rewrite: "{{ item.content_rewrite | default(omit) }}"
    created_by: "{{ item.created_by | default(omit) }}"
    delay_fairness: "{{ item.delay_fairness | default(omit) }}"
    description: "{{ item.description | default(omit) }}"
    dns_info: "{{ item.dns_info | default(omit) }}"
    dns_policies: "{{ item.dns_policies | default(omit) }}"
    east_west_placement: "{{ item.east_west_placement | default(omit) }}"
    enable_autogw: "{{ item.enable_autogw | default(omit) }}"
    enable_rhi: "{{ item.enable_rhi | default(omit) }}"
    enable_rhi_snat: "{{ item.enable_rhi_snat | default(omit) }}"
    enabled: "{{ item.enabled | default(omit) }}"
    error_page_profile_ref: "{{ item.error_page_profile_ref | default(omit) }}"
    flow_dist: "{{ item.flow_dist | default(omit) }}"
    flow_label_type: "{{ item.flow_label_type | default(omit) }}"
    fqdn: "{{ item.fqdn | default(omit) }}"
    host_name_xlate: "{{ item.host_name_xlate | default(omit) }}"
    http_policies: "{{ item.http_policies | default(omit) }}"
    icap_request_profile_refs: "{{ item.icap_request_profile_refs | default(omit) }}"
    ign_pool_net_reach: "{{ item.ign_pool_net_reach | default(omit) }}"
    jwt_config: "{{ item.jwt_config | default(omit) }}"
    l4_policies: "{{ item.l4_policies | default(omit) }}"
    ldap_vs_config: "{{ item.ldap_vs_config | default(omit) }}"
    limit_doser: "{{ item.limit_doser | default(omit) }}"
    markers: "{{ item.markers | default(omit) }}"
    max_cps_per_client: "{{ item.max_cps_per_client | default(omit) }}"
    microservice_ref: "{{ item.microservice_ref | default(omit) }}"
    min_pools_up: "{{ item.min_pools_up | default(omit) }}"
    name: "{{ item.name | default(omit) }}"
    network_profile_ref: "{{ item.network_profile_ref | default(omit) }}"
    network_security_policy_ref: "{{ item.network_security_policy_ref | default(omit) }}"
    nsx_securitygroup: "{{ item.nsx_securitygroup | default(omit) }}"
    oauth_vs_config: "{{ item.oauth_vs_config | default(omit) }}"
    performance_limits: "{{ item.performance_limits | default(omit) }}"
    pool_group_ref: "{{ item.pool_group_ref | default(omit) }}"
    pool_ref: "{{ item.pool_ref | default(omit) }}"
    remove_listening_port_on_vs_down: "{{ item.remove_listening_port_on_vs_down | default(omit) }}"
    requests_rate_limit: "{{ item.requests_rate_limit | default(omit) }}"
    saml_sp_config: "{{ item.saml_sp_config | default(omit) }}"
    scaleout_ecmp: "{{ item.scaleout_ecmp | default(omit) }}"
    se_group_ref: "{{ item.se_group_ref | default(omit) }}"
    security_policy_ref: "{{ item.security_policy_ref | default(omit) }}"
    server_network_profile_ref: "{{ item.server_network_profile_ref | default(omit) }}"
    service_metadata: "{{ item.service_metadata | default(omit) }}"
    service_pool_select: "{{ item.service_pool_select | default(omit) }}"
    services: "{{ item.services | default(omit) }}"
    sideband_profile: "{{ item.sideband_profile | default(omit) }}"
    snat_ip: "{{ item.snat_ip | default(omit) }}"
    sp_pool_refs: "{{ item.sp_pool_refs | default(omit) }}"
    ssl_key_and_certificate_refs: "{{ item.ssl_key_and_certificate_refs | default(omit) }}"
    ssl_profile_ref: "{{ item.ssl_profile_ref | default(omit) }}"
    ssl_profile_selectors: "{{ item.ssl_profile_selectors | default(omit) }}"
    ssl_sess_cache_avg_size: "{{ item.ssl_sess_cache_avg_size | default(omit) }}"
    sso_policy_ref: "{{ item.sso_policy_ref | default(omit) }}"
    static_dns_records: "{{ item.static_dns_records | default(omit) }}"
    tenant_ref: "{{ item.tenant_ref | default(omit) }}"
    test_se_datastore_level_1_ref: "{{ item.test_se_datastore_level_1_ref | default(omit) }}"
    topology_policies: "{{ item.topology_policies | default(omit) }}"
    traffic_clone_profile_ref: "{{ item.traffic_clone_profile_ref | default(omit) }}"
    traffic_enabled: "{{ item.traffic_enabled | default(omit) }}"
    type: "{{ item.type | default(omit) }}"
    use_bridge_ip_as_vip: "{{ item.use_bridge_ip_as_vip | default(omit) }}"
    use_vip_as_snat: "{{ item.use_vip_as_snat | default(omit) }}"
    uuid: "{{ item.uuid | default(omit) }}"
    vh_domain_name: "{{ item.vh_domain_name | default(omit) }}"
    vh_matches: "{{ item.vh_matches | default(omit) }}"
    vh_parent_vs_ref: "{{ item.vh_parent_vs_ref | default(omit) }}"
    vh_type: "{{ item.vh_type | default(omit) }}"
    vip: "{{ item.vip | default(omit) }}"
    vrf_context_ref: "{{ item.vrf_context_ref | default(omit) }}"
    vs_datascripts: "{{ item.vs_datascripts | default(omit) }}"
    vsvip_cloud_config_cksum: "{{ item.vsvip_cloud_config_cksum | default(omit) }}"
    vsvip_ref: "{{ item.vsvip_ref | default(omit) }}"
    waf_policy_ref: "{{ item.waf_policy_ref | default(omit) }}"
    weight: "{{ item.weight | default(omit) }}"
  when:
    - (avi_role_state_mode == "present" and avi_config_state == "present")
    - (item.state | default("present") == avi_role_state_mode or avi_config_state == "absent")
  with_items: "{{ avi_role_cfg.virtualservice | default([]) }}"
